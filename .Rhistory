"<br>",
" Q = ", Q, ", <i>p</i> < .005",
"<br>",
" <i>I<sup>2</sup></i> = ", i2, "%",
", <i>T<sup>2</sup></i> = ", t2),
x = 19,
y = -1.5),
size = 1.8,
label.colour = NA,
hjust = 0)
dev.off()
png(filename = "figures/Figure5.png",
units = "in",
width = 9,
height = 5.07,
res = 300)
ggplot(data = meta.DF,
aes(x = country,
y = d,
ymin = lb,
ymax = ub)) +
geom_hline(yintercept = 0,
color = "black",
linetype = "dashed",
alpha = .5) +
geom_point(aes(shape = as.factor(overall),
size = as.factor(overall),
colour = as.factor(overall))) +
geom_errorbar(width = .5,
aes(colour = as.factor(overall))) +
scale_shape_manual(values = c(15, 18)) +
scale_size_manual(values = c(2, 4)) +
scale_color_manual(values= c("dark grey",
"#3366FF")) +
coord_flip() +
facet_grid(cols = vars(condition)) +
labs(y = expression(paste("Cohen's ",
italic("d"),
"(Happy pose minus neutral pose)")),
x = "Country") +
ylim(-1.5, 1.3) +
geom_richtext(data = meta.DF[meta.DF$overall == 1, ],
aes(label = paste0("overall <i>d</i> = ", round(d, 2),
" [", round(lb, 2), ", ",
round(ub, 2), "]",
"<br>",
" Q = ", Q, ", <i>p</i> < .005",
"<br>",
" <i>I<sup>2</sup></i> = ", i2, "%",
", <i>T<sup>2</sup></i> = ", t2),
x = 1,
y = -1.5),
size = 1.8,
label.colour = NA,
hjust = 0)
dev.off()
png(filename = "figures/Figure5.png",
units = "in",
width = 9,
height = 5.07,
res = 300)
ggplot(data = meta.DF,
aes(x = country,
y = d,
ymin = lb,
ymax = ub)) +
geom_hline(yintercept = 0,
color = "black",
linetype = "dashed",
alpha = .5) +
geom_point(aes(shape = as.factor(overall),
size = as.factor(overall),
colour = as.factor(overall))) +
geom_errorbar(width = .5,
aes(colour = as.factor(overall))) +
scale_shape_manual(values = c(15, 18)) +
scale_size_manual(values = c(2, 4)) +
scale_color_manual(values= c("dark grey",
"#3366FF")) +
coord_flip() +
facet_grid(cols = vars(condition)) +
labs(y = expression(paste("Cohen's ",
italic("d"),
"(Happy pose minus neutral pose)")),
x = "Country") +
ylim(-1.5, 1.3) +
geom_richtext(data = meta.DF[meta.DF$overall == 1, ],
aes(label = paste0("overall <i>d</i> = ", round(d, 2),
" [", round(lb, 2), ", ",
round(ub, 2), "]",
"<br>",
" Q = ", Q, ", <i>p</i> < .005",
"<br>",
" <i>I<sup>2</sup></i> = ", i2, "%",
", <i>T<sup>2</sup></i> = ", t2),
x = 1.1,
y = -1.5),
size = 1.8,
label.colour = NA,
hjust = 0)
dev.off()
png(filename = "figures/Figure5.png",
units = "in",
width = 9,
height = 5.07,
res = 300)
ggplot(data = meta.DF,
aes(x = country,
y = d,
ymin = lb,
ymax = ub)) +
geom_hline(yintercept = 0,
color = "black",
linetype = "dashed",
alpha = .5) +
geom_point(aes(shape = as.factor(overall),
size = as.factor(overall),
colour = as.factor(overall))) +
geom_errorbar(width = .5,
aes(colour = as.factor(overall))) +
scale_shape_manual(values = c(15, 18)) +
scale_size_manual(values = c(2, 4)) +
scale_color_manual(values= c("dark grey",
"#3366FF")) +
coord_flip() +
facet_grid(cols = vars(condition)) +
labs(y = expression(paste("Cohen's ",
italic("d"),
"(Happy pose minus neutral pose)")),
x = "Country") +
ylim(-1.5, 1.3) +
geom_richtext(data = meta.DF[meta.DF$overall == 1, ],
aes(label = paste0("overall <i>d</i> = ", round(d, 2),
" [", round(lb, 2), ", ",
round(ub, 2), "]",
"<br>",
" Q = ", Q, ", <i>p</i> < .005",
"<br>",
" <i>I<sup>2</sup></i> = ", i2, "%",
", <i>T<sup>2</sup></i> = ", t2),
x = 1.1,
y = -1.5),
size = 1.8,
label.colour = NA,
hjust = 0)
dev.off()
png(filename = "figures/Figure5.png",
units = "in",
width = 9,
height = 5.07,
res = 300)
ggplot(data = meta.DF,
aes(x = country,
y = d,
ymin = lb,
ymax = ub)) +
geom_hline(yintercept = 0,
color = "black",
linetype = "dashed",
alpha = .5) +
geom_point(aes(shape = as.factor(overall),
size = as.factor(overall),
colour = as.factor(overall))) +
geom_errorbar(width = .5,
aes(colour = as.factor(overall))) +
scale_shape_manual(values = c(15, 18)) +
scale_size_manual(values = c(2, 4)) +
scale_color_manual(values= c("dark grey",
"#3366FF")) +
coord_flip() +
facet_grid(cols = vars(condition)) +
labs(y = expression(paste("Cohen's ",
italic("d"),
"(Happy pose minus neutral pose)")),
x = "Country") +
ylim(-1.5, 1.3) +
geom_richtext(data = meta.DF[meta.DF$overall == 1, ],
aes(label = paste0("overall <i>d</i> = ", round(d, 2),
" [", round(lb, 2), ", ",
round(ub, 2), "]",
"<br>",
" Q = ", Q, ", <i>p</i> < .005",
"<br>",
" <i>I<sup>2</sup></i> = ", i2, "%",
", <i>T<sup>2</sup></i> = ", t2),
x = 1.1,
y = -1.25),
size = 1.8,
label.colour = NA,
hjust = 0)
dev.off()
png(filename = "figures/Figure5.png",
units = "in",
width = 9,
height = 5.07,
res = 300)
ggplot(data = meta.DF,
aes(x = country,
y = d,
ymin = lb,
ymax = ub)) +
geom_hline(yintercept = 0,
color = "black",
linetype = "dashed",
alpha = .5) +
geom_point(aes(shape = as.factor(overall),
size = as.factor(overall),
colour = as.factor(overall))) +
geom_errorbar(width = .5,
aes(colour = as.factor(overall))) +
scale_shape_manual(values = c(15, 18)) +
scale_size_manual(values = c(2, 4)) +
scale_color_manual(values= c("dark grey",
"#3366FF")) +
coord_flip() +
facet_grid(cols = vars(condition)) +
labs(y = expression(paste("Cohen's ",
italic("d"),
"(Happy pose minus neutral pose)")),
x = "Country") +
ylim(-1.5, 1.3) +
geom_richtext(data = meta.DF[meta.DF$overall == 1, ],
aes(label = paste0("overall <i>d</i> = ", round(d, 2),
" [", round(lb, 2), ", ",
round(ub, 2), "]",
"<br>",
" Q = ", Q, ", <i>p</i> < .005",
"<br>",
" <i>I<sup>2</sup></i> = ", i2, "%",
", <i>T<sup>2</sup></i> = ", t2),
x = 1.25,
y = -1.5),
size = 1.8,
label.colour = NA,
hjust = 0)
dev.off()
ggplot(data = meta.DF,
aes(x = country,
y = d,
ymin = lb,
ymax = ub)) +
geom_hline(yintercept = 0,
color = "black",
linetype = "dashed",
alpha = .5) +
geom_point(aes(shape = as.factor(overall),
size = as.factor(overall),
colour = as.factor(overall))) +
geom_errorbar(width = .5,
aes(colour = as.factor(overall))) +
scale_shape_manual(values = c(15, 18)) +
scale_size_manual(values = c(2, 4)) +
scale_color_manual(values= c("dark grey",
"#3366FF")) +
coord_flip() +
facet_grid(cols = vars(condition)) +
labs(y = expression(paste("Cohen's ",
italic("d"),
"(Happy pose minus neutral pose)")),
x = "Country") +
ylim(-1.5, 1.3) +
geom_richtext(data = meta.DF[meta.DF$overall == 1, ],
aes(label = paste0("overall <i>d</i> = ", round(d, 2),
" [", round(lb, 2), ", ",
round(ub, 2), "]",
"<br>",
" Q = ", Q, ", <i>p</i> < .005",
"<br>",
" <i>I<sup>2</sup></i> = ", i2, "%",
", <i>T<sup>2</sup></i> = ", t2),
x = 1.25,
y = -1.5),
size = 1.8,
label.colour = NA,
hjust = 0)
png(filename = "figures/Figure5.png",
units = "in",
width = 9,
height = 5.07,
res = 300)
ggplot(data = meta.DF,
aes(x = country,
y = d,
ymin = lb,
ymax = ub)) +
geom_hline(yintercept = 0,
color = "black",
linetype = "dashed",
alpha = .5) +
geom_point(aes(shape = as.factor(overall),
size = as.factor(overall),
colour = as.factor(overall))) +
geom_errorbar(width = .5,
aes(colour = as.factor(overall))) +
scale_shape_manual(values = c(15, 18)) +
scale_size_manual(values = c(2, 4)) +
scale_color_manual(values= c("dark grey",
"#3366FF")) +
coord_flip() +
facet_grid(cols = vars(condition)) +
labs(y = expression(paste("Cohen's ",
italic("d"),
"(Happy pose minus neutral pose)")),
x = "Country") +
ylim(-1.5, 1.3) +
geom_richtext(data = meta.DF[meta.DF$overall == 1, ],
aes(label = paste0("overall <i>d</i> = ", round(d, 2),
" [", round(lb, 2), ", ",
round(ub, 2), "]",
"<br>",
" Q = ", Q, ", <i>p</i> < .005",
"<br>",
" <i>I<sup>2</sup></i> = ", i2, "%",
", <i>T<sup>2</sup></i> = ", t2),
x = 1.25,
y = -1.5),
size = 1.8,
label.colour = NA,
hjust = 0)
dev.off()
png(filename = "figures/Figure5.png",
units = "in",
width = 9,
height = 5.07,
res = 300)
ggplot(data = meta.DF,
aes(x = country,
y = d,
ymin = lb,
ymax = ub)) +
geom_hline(yintercept = 0,
color = "black",
linetype = "dashed",
alpha = .5) +
geom_point(aes(shape = as.factor(overall),
size = as.factor(overall),
colour = as.factor(overall))) +
geom_errorbar(width = .5,
aes(colour = as.factor(overall))) +
scale_shape_manual(values = c(15, 18)) +
scale_size_manual(values = c(2, 4)) +
scale_color_manual(values= c("dark grey",
"#3366FF")) +
coord_flip() +
facet_grid(cols = vars(condition)) +
labs(y = expression(paste("Cohen's ",
italic("d"),
"(Happy pose minus neutral pose)")),
x = "Country") +
ylim(-1.5, 1.3) +
geom_richtext(data = meta.DF[meta.DF$overall == 1, ],
aes(label = paste0("overall <i>d</i> = ", round(d, 2),
" [", round(lb, 2), ", ",
round(ub, 2), "]",
"<br>",
" Q = ", Q, ", <i>p</i> < .005",
"<br>",
" <i>I<sup>2</sup></i> = ", i2, "%",
", <i>T<sup>2</sup></i> = ", t2),
x = 1.18,
y = -1.5),
size = 1.8,
label.colour = NA,
hjust = 0)
dev.off()
png(filename = "figures/Figure5.png",
units = "in",
width = 9,
height = 5.07,
res = 300)
ggplot(data = meta.DF,
aes(x = country,
y = d,
ymin = lb,
ymax = ub)) +
geom_hline(yintercept = 0,
color = "black",
linetype = "dashed",
alpha = .5) +
geom_point(aes(shape = as.factor(overall),
size = as.factor(overall),
colour = as.factor(overall))) +
geom_errorbar(width = .5,
aes(colour = as.factor(overall))) +
scale_shape_manual(values = c(15, 18)) +
scale_size_manual(values = c(2, 4)) +
scale_color_manual(values= c("dark grey",
"#3366FF")) +
coord_flip() +
facet_grid(cols = vars(condition)) +
labs(y = expression(paste("Cohen's ",
italic("d"),
"(Happy pose minus neutral pose)")),
x = "Country") +
ylim(-1.5, 1.3) +
geom_richtext(data = meta.DF[meta.DF$overall == 1, ],
aes(label = paste0("overall <i>d</i> = ", round(d, 2),
" [", round(lb, 2), ", ",
round(ub, 2), "]",
"<br>",
" Q = ", Q, ", <i>p</i> < .005",
"<br>",
" <i>I<sup>2</sup></i> = ", i2, "%",
", <i>T<sup>2</sup></i> = ", t2),
x = 1.18,
y = -1.5),
size = 1.8,
label.colour = NA,
fill = NA
hjust = 0)
dev.off()
png(filename = "figures/Figure5.png",
units = "in",
width = 9,
height = 5.07,
res = 300)
ggplot(data = meta.DF,
aes(x = country,
y = d,
ymin = lb,
ymax = ub)) +
geom_hline(yintercept = 0,
color = "black",
linetype = "dashed",
alpha = .5) +
geom_point(aes(shape = as.factor(overall),
size = as.factor(overall),
colour = as.factor(overall))) +
geom_errorbar(width = .5,
aes(colour = as.factor(overall))) +
scale_shape_manual(values = c(15, 18)) +
scale_size_manual(values = c(2, 4)) +
scale_color_manual(values= c("dark grey",
"#3366FF")) +
coord_flip() +
facet_grid(cols = vars(condition)) +
labs(y = expression(paste("Cohen's ",
italic("d"),
"(Happy pose minus neutral pose)")),
x = "Country") +
ylim(-1.5, 1.3) +
geom_richtext(data = meta.DF[meta.DF$overall == 1, ],
aes(label = paste0("overall <i>d</i> = ", round(d, 2),
" [", round(lb, 2), ", ",
round(ub, 2), "]",
"<br>",
" Q = ", Q, ", <i>p</i> < .005",
"<br>",
" <i>I<sup>2</sup></i> = ", i2, "%",
", <i>T<sup>2</sup></i> = ", t2),
x = 1.18,
y = -1.5),
size = 1.8,
label.colour = NA,
fill = NA,
hjust = 0)
dev.off()
pose.es.DF <- DF.l %>%
# pivot data wider
pivot_wider(names_from = trial,
values_from = happiness,
id_cols = c(ResponseId,
country,
lab,
UserLanguage,
condition)) %>%
# calculate difference score
rowwise() %>%
mutate(diff = happy - neutr) %>%
# for each condition and country, find correlation between two trials and the mean/sd of the difference score
group_by(condition, country) %>%
summarise(n = n(),
corr = cor(happy, neutr),
m.diff = mean(diff),
sd.diff = sd(diff)) %>%
ungroup() %>%
# calculate cohen drm
# formula: Cooper, Hedges, & Valentine, 2009; p. 229
rowwise() %>%
mutate(d = (m.diff / sd.diff) *
sqrt(2 * (1 - corr))) %>%
# calculate variance of d
mutate(d.var = ((1 / n) + ((d^2) / (2 * n))) *
2 * (1 - corr)) %>%
# calculate CI of d
mutate(lb = d - (1.96 * sqrt(d.var)),
ub = d + (1.96 * sqrt(d.var))) %>%
# select relevant variables
select(condition, country, d, d.var, lb, ub)
# fit meta-analyses
meta.m  <- rma(
yi = d,
vi = d.var,
slab = country,
data = meta.DF,
subset = condition == "mimicry"
)
meta.d <- rma(
yi = d,
vi = d.var,
slab = country,
data = meta.DF,
subset = condition == "directd"
)
meta.p <- rma(
yi = d,
vi = d.var,
slab = country,
data = meta.DF,
subset = condition == "pentask"
)
View(meta.DF)
